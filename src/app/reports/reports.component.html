<div class="layout">
    <app-header></app-header>
    <div class="parent-container">
        <app-station-title></app-station-title>
        <app-sidebar></app-sidebar>
        <div class="main-content">
            <!-- <h2>Station Reports</h2> -->
            <div class="form-box">
                <form [formGroup]="reportForm" (ngSubmit)="onSubmit()">
                    <div class="form-container">
                        <label for="startDate">Start Date</label>
                        <input 
                            type="date" 
                            id="startDate" 
                            formControlName="startDate" 
                            [min]="minStartDate"
                          />
                        <label for="endDate">End Date</label>
                        <input
                        id="endDate"
                        type="date"
                        formControlName="endDate"
                        [min]="reportForm.get('startDate')?.value" />

                        <button type="submit">Create Report</button>
                        <button type="button" (click)="exportToCSV()">Export CSV</button>
                    </div>
                </form>
            </div>
            <div class="table-container">
            <p *ngIf="!formattedData.length" class="no-data">No data available for the selected date range.</p>

                <table *ngIf="formattedData.length > 0">
                    <thead>
                      <tr>
                        <!-- Dynamic Display Headers -->
                        <th *ngFor="let header of displayHeaders">{{ header }}</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let row of formattedData">
                        <!-- Dynamic Row Values -->
                        <td *ngFor="let key of headers">
                          {{ row[key] !== null && row[key] !== undefined ? row[key] : 'N/A' }}
                        </td>
                      </tr>
                    </tbody>
                  </table>
      
    </div>
</div>